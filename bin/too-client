#!/usr/bin/env perl

use strict;
use warnings;

use feature ':5.14';

use Getopt::Long;
use IO::Socket::INET;

$| = 1;

my $host    = '127.0.0.1';
my $port    = 7777;
my $verbose = 0;
GetOptions(
    'host=s'    => \$host,
    'port=s'    => \$port,
    'verbose|v' => \$verbose,
);

my $socket = new IO::Socket::INET (
    PeerHost => $host,
    PeerPort => $port,
    Proto    => 'tcp',
);
die "cannot connect to the server $!\n" unless $socket;

say 'connected to the server.' if $verbose;

my $test_target = $ARGV[0];
my $size = $socket->send($test_target);
say "sent: $test_target" if $verbose;

shutdown $socket, 1;

$socket->close();
