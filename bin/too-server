#!/usr/bin/env perl

use strict;
use warnings;

use feature ':5.14';

use FindBin;
use lib "$FindBin::Bin/../lib";
use Getopt::Long;

use TheOtherOne;

my $server_type_original = '';
my $server_type = 'Socket';
my $socket_port = '7777';
GetOptions(
  'server=s' => sub {
    my $server_type_original = $_[1];
    $server_type = ucfirst(lc($server_type_original));
  },
  'port=s'   => \$socket_port,
);

given($server_type) {
  when (TheOtherOne::SOCKET) {
    TheOtherOne->server($_)->start($socket_port);
  }
  when (TheOtherOne::SIGNAL) {
    TheOtherOne->server($_)->start($ARGV[0]);
  }
  default {
    say "unknown server type: $server_type_original";
  }
}
